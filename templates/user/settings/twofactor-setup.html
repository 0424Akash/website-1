{% extends 'user/settings/index.html' %}
{% load two_factor i18n %}
{% block errors %}
    {% for error in wizard.form.errors %}
        <p class="alert error">
            {{ error }}
        </p>
    {% endfor %}
{% endblock %}
{% block navpills %}
    <li><a href="{% url 'user-settings' %}">{% trans "General" %}</a></li>
    <li><a href="{% url 'user-password' %}">{% trans "Change Password" %}</a></li>
    <li><a href="{% url 'user-liberate' %}">{% trans "Liberate Data" %}</a></li>
    <li class="active"><a href="{% url 'user-twofactor' %}">{% trans "Two Factor Authentication" %}</a></li>
    <li><a href="{% url 'user-delete' %}">{% trans "Delete Account" %}</a></li>
{% endblock %}

{% block form %}
{% if wizard.steps.current == 'welcome' %}
    <p>{% blocktrans %}
        You are about to take your account security to the next level. Follow
        the steps in this wizard to enable two-factor authentication.
    {% endblocktrans %}</p>
{% elif wizard.steps.current == 'method' %}
    <p>{% blocktrans %}
        Please select which authentication method you would like to use.
    {% endblocktrans %}</p>
{% elif wizard.steps.current == 'generator' %}
    <p>{% blocktrans %}
        To start using a token generator, please use your smartphone to scan
        the QR code below. For example, use Google Authenticator. Then, enter
        the token generated by the app.
    {% endblocktrans %}</p>
    <p><img src="{{ QR_URL }}" alt="QR Code" /></p>
{% elif wizard.steps.current == 'yubikey' %}
    <p>{% blocktrans %}
        To identify and verify your YubiKey, please insert a token in the field
        below. Your YubiKey will be linked to your account.
    {% endblocktrans %}</p>
{% endif %}

<form action="{% url 'user-twofactor-setup' %}" method="post">
    {% csrf_token %}
    {{ wizard.management_form }}
    <div class="form-group">
        {% for field in wizard.form %}
            {{ field.label_tag }}{{ field }}
        {% endfor %}
    </div>

    <button type="submit" class="btn btn-primary">{% trans "Next" %}</button>
    <a href="{% url 'user-twofactor' %}" class="btn btn-default">{% trans "Cancel" %}</a>
</form>
{% endblock %}
