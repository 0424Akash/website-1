{% extends 'user/settings/index.html' %}
{% load i18n %}

{% block navpills %}
    <li><a href="{% url 'user-settings' %}">{% trans "General" %}</a></li>
    <li><a href="{% url 'user-password' %}">{% trans "Change Password" %}</a></li>
    <li class="active"><a href="{% url 'user-liberate' %}">{% trans "Liberate Data" %}</a></li>
    <li><a href="{% url 'user-delete' %}">{% trans "Delete Account" %}</a></li>
{% endblock %}

{% block form %}
{% if object.flags.running %}
    <p>{% blocktrans with started=object.started|timesince %}
        Liberation was requested {{ started }} ago and is still pending. Please waitâ€¦
    {% endblocktrans %}</p>
{% else %}
    {% if object.last_finished %}
    <div class="panel panel-primary">
        <div class="panel-body">
            <p>{% blocktrans with finished=object.last_finished|timesince %}
                Your data is available for download. It was generated {{ finished }} ago.
            {% endblocktrans %}</p>
            <a class="btn btn-primary" href="{% url 'user-liberate-get' %}">{% trans "Download" %}</a>
        </div>
    </div>
    {% endif %}
    <form class="form" action="{% url 'user-liberate' %}" method="POST">
        {% csrf_token %}
        <div class="form-group">
            {{ form.as_p }}
        </div>
        <button class="btn btn-default">{% trans "Liberate!" %}</button>
    </form>
{% endif %}
{% endblock %}
